# AI戦略プレゼンテーション & チャットボット 利用マニュアル

バージョン: 4.0 (Browser-Native Edition)  
最終更新日: 2026/01/26

このシステムは、手持ちの資料をAIに読み込ませ、プレゼンテーション中にリアルタイムで質問に答えさせるツールです。
難しい設定は不要です。このマニュアル通りに進めれば、約10分であなただけのAIプレゼン環境が整います。

---

## 🔰 はじめに：このシステムの仕組み

このシステムは、以下の3ステップで動きます。

1.  **読む（Data）**: PDFなどの資料を、AIが理解できる「数字の羅列（ベクトル）」に変換します。
2.  **探す（Search）**: あなたの質問に近い情報を、ブラウザが瞬時に探し出します。
3.  **答える（Generate）**: Google Gemini AIが、見つけた情報を元に回答を作ります。

---

## 1. 準備するもの

| 項目 | 説明 |
| :--- | :--- |
| **パソコン** | Windows 10/11, macOS など |
| **Python** | プログラムを動かすためのソフト。バージョン3.10以上が必要です。 |
| **APIキー** | GoogleのAIを使うためのパスワードのようなもの。[Google AI Studio](https://aistudio.google.com/app/apikey) から無料で取得できます。 |
| **資料** | AIに読ませたいPDF、テキスト、Markdownファイルなどを `data` フォルダに入れておきます。 |

---

## 2. セットアップ手順

### Step 1. プログラムの準備

まず、システムに必要な部品（ライブラリ）をインストールします。
コマンドプロンプト（またはターミナル）を開き、このフォルダまで移動して以下のコマンドを入力してください。

```powershell
pip install -r requirements.txt

```

※ 画面に文字がたくさん流れますが、最後にエラーが出ていなければOKです。

---

### Step 2. AIに資料を学習させる（重要！）

ここが最も重要なステップです。`data` フォルダに入れた資料を、AI用の辞書ファイル（`rag_index.json`）に変換します。

**注意:** AIに「言葉の意味」を理解させるため、**ここで必ず APIキー を使います。**

以下のコマンドの `"AIza..."` の部分を、あなたのAPIキーに書き換えて実行してください。

```powershell
$key = Read-Host -AsSecureString "Gemini APIキーを貼り付けてEnterを押してください"
$apiKey = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($key))
python build_rag_index.py --root data --out rag_index.json --api-key $apiKey

```
* 上記をまとめてコピーします。
* PowerShellに「右クリック」で貼り付けます。
* 「Gemini APIキーを貼り付けて...」と表示されたら、取得したキーを貼り付けてEnter キーを押します。
* 自動的に学習（インデックス作成）が始まります。

**画面に以下のように表示されれば成功です：**

```text
  ✓ data/提案資料.pdf (2500 chars, embedded)
  ✓ data/補足メモ.txt (800 chars, embedded)
...
✓ Found 5 documents, writing rag_index.json

```

* **ポイント**: `embedded` と表示されていることを確認してください。これが表示されない場合、AIは資料の意味を理解できていません（APIキーの入力ミスなどが原因です）。

---

### Step 3. プレゼンテーションの起動

準備は完了です！画面を立ち上げましょう。

1. フォルダ内の **`start_presentation.bat`** をダブルクリックします。
* 黒い画面が立ち上がり、自動的にブラウザが開きます。
* もし自動で開かない場合は、ブラウザのアドレスバーに `http://localhost:8000/new_index.html` と入力してください。


2. ブラウザ画面右下の **ロボットアイコン** をクリックします。
3. チャット画面に **APIキー** を入力します。
* セキュリティのため、キーはあなたのブラウザ内にのみ保存されます。外部に漏れることはありません。



---

## 3. 使い方ガイド

### プレゼンテーション操作

* **スライド送り**: キーボードの `→` または `Space` キー、画面上の矢印ボタン。
* **スライド戻し**: キーボードの `←` キー。

### AIチャット操作

* 画面右下のアイコンでチャットを開閉できます。
* 質問を入力して Enter を押すと、AIが資料の中から答えを探して回答します。
* **特徴**: AIは現在表示しているスライドの内容も把握しています。「このページの数字の根拠は？」といった質問も可能です。

---

## 4. よくある質問とトラブル解決

### Q. チャットで「資料が見つかりません」と言われます。

**A. Step 2の学習がうまくいっていない可能性があります。**
`rag_index.json` を一度削除し、Step 2のコマンドを再度実行してください。その際、必ず `--api-key` オプションを付けてください。

### Q. 回答が遅い、または途中で止まる。

**A. 通信環境を確認してください。**
このシステムはインターネット経由でGoogleのAIを利用します。また、無料版のAPIキーを使用している場合、一時的に利用制限がかかっている可能性があります。少し待ってから再度試してください。

### Q. 画面が真っ白になる、ボタンが反応しない。

**A. ブラウザのキャッシュが原因かもしれません。**
`Ctrl + Shift + R` (Macは `Cmd + Shift + R`) を押して、ページを完全に再読み込みしてください。また、必ず `start_presentation.bat` 経由（ローカルサーバー）で開いていることを確認してください（ファイルを直接ダブルクリックでは動きません）。

---

## 5. ファイル構成（上級者向け）

* **new_index.html**: メインのプレゼン画面（React + Tailwind CSS）。すべてのロジックはここに含まれています。
* **build_rag_index.py**: 資料を読み込み、ベクトル化（Embedding）してJSONを作るPythonスクリプト。
* **rag_index.json**: 作成された辞書データ。これには本文とベクトルデータの両方が含まれます。

```

---

### 更新のポイントまとめ
1.  **`build_rag_index.py` の手順修正**: `new_index.html` はブラウザ側でベクトル計算を行うため、JSONファイル内にあらかじめベクトルデータ（Embedding）が含まれていることが**必須動作要件**となりました。そのため、マニュアルではAPIキーなしでの実行手順を削除し、**「APIキー必須」**として案内しています。
2.  **`query_rag.py` の除外**: 初心者が混乱しないよう、CUIツールの説明は省き、ブラウザでの利用のみに焦点を絞りました。
3.  **URLの案内**: `start_presentation.bat` が古い `index.html` を開く可能性があるため、トラブルシューティングで `new_index.html` を開くよう明記しました（あるいはバッチファイル側も修正することをお勧めします）。

```
